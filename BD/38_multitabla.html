<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="exe_effects.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>3.8. Multitabla | Modelo Entidad - Relación </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="David Bermúdez Alcántara" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.5 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="exe_effects.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
	</head>
<body class="exe-web-site" id="exe-node-58"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">Modelo Entidad - Relación</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Modelo Entidad Relación</a></li>
   <li><a href="normativa.html" class="daddy">Normativa</a>
   <ul class="other-section">
      <li><a href="resultados_de_aprendizaje_y_criterios_de_evaluacin.html" class="no-ch">Resultados de Aprendizaje y Criterios de Evaluación</a></li>
      <li><a href="contenidos_bsicos.html" class="no-ch">Contenidos Básicos</a></li>
      <li><a href="orientaciones_pedaggicas.html" class="no-ch">Orientaciones Pedagógicas</a></li>
      <li><a href="elementos_necesarios.html" class="no-ch">Elementos necesarios</a></li>
      <li><a href="bibliografa.html" class="no-ch">Bibliografía</a></li>
   </ul>
   </li>
   <li><a href="ud_1_introduccin_a_las_bbdd_relacionales.html" class="daddy">UD 1. Introducción a las BBDD relacionales</a>
   <ul class="other-section">
      <li><a href="11_aplicaciones_de_los_sgbd.html" class="no-ch">1.1. Aplicaciones de los SGBD</a></li>
      <li><a href="12_los_datos.html" class="no-ch">1.2. Los datos</a></li>
      <li><a href="13_modelos_de_datos.html" class="no-ch">1.3. Modelos de datos</a></li>
      <li><a href="14_lenguajes_de_bases_de_datos.html" class="no-ch">1.4. Lenguajes de bases de datos</a></li>
      <li><a href="autoevaluacin.html" class="no-ch">Autoevaluación</a></li>
      <li><a href="practica.html" class="no-ch">Practica</a></li>
   </ul>
   </li>
   <li><a href="ud2_bases_de_datos_relacionales.html" class="daddy">UD2. Bases de Datos Relacionales</a>
   <ul class="other-section">
      <li><a href="21_conceptos_bsicos.html" class="no-ch">2.1. Conceptos básicos</a></li>
      <li><a href="22_dominios.html" class="no-ch">2.2. Dominios</a></li>
      <li><a href="23_claves.html" class="no-ch">2.3. Claves</a></li>
      <li><a href="24_el_lenguaje_de_consultas_sql.html" class="no-ch">2.4. El lenguaje de consultas: SQL</a></li>
      <li><a href="25_componentes_del_sql.html" class="no-ch">2.5. Componentes del SQL</a></li>
      <li><a href="26_tipos_de_datos.html" class="no-ch">2.6. Tipos de datos</a></li>
      <li><a href="27_constantes_y_nulos.html" class="no-ch">2.7. Constantes y Nulos</a></li>
      <li><a href="autoevaluacin0.html" class="no-ch">Autoevaluación</a></li>
      <li><a href="practica0.html" class="no-ch">Practica</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="ud3_sql_select.html" class="current-page-parent daddy">UD3. SQL: SELECT</a>
   <ul>
      <li><a href="31_la_clusula_select.html" class="no-ch">3.1. La cláusula SELECT</a></li>
      <li><a href="32_select_bsico.html" class="no-ch">3.2. SELECT básico</a></li>
      <li><a href="33_filas_duplicadas.html" class="no-ch">3.3. Filas duplicadas</a></li>
      <li><a href="34_condiciones.html" class="no-ch">3.4. Condiciones</a></li>
      <li><a href="35_condiciones_compuestas.html" class="no-ch">3.5. Condiciones compuestas</a></li>
      <li><a href="36_ordenacin.html" class="no-ch">3.6. Ordenación</a></li>
      <li><a href="37_unin.html" class="no-ch">3.7. Unión</a></li>
      <li id="active"><a href="38_multitabla.html" class="active no-ch">3.8. Multitabla</a></li>
      <li><a href="39_consultas_sumarias.html" class="no-ch">3.9. Consultas sumarias</a></li>
      <li><a href="autoevaluacin1.html" class="no-ch">Autoevaluación</a></li>
      <li><a href="practica1.html" class="no-ch">Practica</a></li>
   </ul>
   </li>
   <li><a href="ud4_sql_insert_y_delete.html" class="daddy">UD4. SQL: INSERT y DELETE</a>
   <ul class="other-section">
      <li><a href="41_la_clusula_insert.html" class="no-ch">4.1. La cláusula INSERT</a></li>
      <li><a href="42_insert_bsico.html" class="no-ch">4.2. INSERT básico</a></li>
      <li><a href="43_insertar_con_insert.html" class="no-ch">4.3. Insertar con INSERT</a></li>
      <li><a href="44_insercin_masiva.html" class="no-ch">4.4. Inserción masiva</a></li>
      <li><a href="45_la_clusula_delete.html" class="no-ch">4.5. La cláusula DELETE</a></li>
      <li><a href="46_borrado_con_subconsultas.html" class="no-ch">4.6. Borrado con subconsultas</a></li>
   </ul>
   </li>
   <li><a href="ud5_sql_update.html" class="daddy">UD5. SQL: UPDATE</a>
   <ul class="other-section">
      <li><a href="51_la_clusula_update.html" class="no-ch">5.1. La cláusula UPDATE</a></li>
      <li><a href="52_actualizacin_de_todas_las_filas.html" class="no-ch">5.2. Actualización de todas las filas</a></li>
      <li><a href="53_actualizar_con_subconsultas.html" class="no-ch">5.3. Actualizar con subconsultas</a></li>
   </ul>
   </li>
   <li><a href="ud6_sql_create_drop_y_alter.html" class="daddy">UD6. SQL: CREATE, DROP Y ALTER</a>
   <ul class="other-section">
      <li><a href="61_creacin_de_tablas.html" class="no-ch">6.1. Creación de tablas</a></li>
      <li><a href="62_definicin_de_columnas.html" class="no-ch">6.2. Definición de columnas</a></li>
      <li><a href="63_definicin_de_claves.html" class="no-ch">6.3. Definición de claves</a></li>
      <li><a href="seccin.html" class="no-ch">Sección</a></li>
      <li><a href="seccin0.html" class="no-ch">Sección</a></li>
   </ul>
   </li>
   <li><a href="bloque_3_modelo_entidad__relacin.html" class="no-ch">Bloque 3. Modelo Entidad - Relación</a></li>
   <li><a href="bloque_4_lenguaje_script_plsql.html" class="no-ch">Bloque 4. Lenguaje Script PL/SQL</a></li>
   <li><a href="bibliografa0.html" class="no-ch">Bibliografía</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="37_unin.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="39_consultas_sumarias.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">3.8. Multitabla</h1></header>
<article class="iDevice_wrapper textIdevice" id="id127">
<div class="iDevice emphasis0" >
<div id="ta127_133_2" class="block iDevice_content">
<div class="exe-text"><p>Muchas consultas útiles solicitan datos procedentes de dos o más tablas en la base de datos.</p>
<p>Por ejemplo, las siguientes consultas extraen los datos de varias tablas:</p>
<ul>
<li>Lista los productos y la categoría a la que pertenecen (tablas PRODUCTOS y CATEGORIAS).</li>
<li>Lista los pedidos mostrando el importe del pedido, el nombre del cliente que lo ordenó y el nombre del producto solicitado (tablas PEDIDOS, CLIENTES, DETALLES DEL PEDIDO y PRODUCTOS).</li>
<li>Muestra todas los pedidos aceptados enviados a Alemania, mostrando la descripción del producto y el vendedor (tablas PEDIDOS, DETALLES DEL PEDIDO, EMPLEADOS y PRODUCTOS).</li>
</ul>
<p>SQL permite recuperar datos que responden a estas peticiones mediante consultas multitabla que componen (<strong>JOIN</strong>) datos procedentes de dos o más tablas. Por ejemplo, la consulta “lista todos los pedidos, mostrando su número, nombre del cliente, producto vendido e importe" se realiza de cualquiera de las siguientes formas:</p>
<p style="text-align: center;"><span style="font-family: andale mono, monospace;"><em>SELECT IdPedido, NombreCompañía, Producto, Cargo FROM pedidos, clientes WHERE clie=num_clie</em></span></p>
<p style="text-align: center;"><span style="font-family: andale mono, monospace;"><em>SELECT IdPedido, NombreCompañía, Producto, Cargo FROM pedidos INNER JOIN clientes ON clie=num_clie;</em></span></p>
<p style="text-align: left;"><span style="font-family: verdana, geneva, sans-serif;">Luego se pueden utilizar todo lo aprendido hasta ahora para filtrar los resultados que se desean obtener.<br /></span></p>
<p></p></div>
</div>
</div>
</article>
<article class="iDevice_wrapper preknowledgeIdevice em_iDevice" id="id128">
<div class="iDevice emphasis1" >
<header class="iDevice_header"><h1 class="iDeviceTitle">Consultas sobre 3 o más tablas</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta128_134_2" class="block iDevice_content">
<p>SQL puede combinar datos de tres o más tablas utilizando las mismas técnicas básicas utilizadas para las consultas de dos tablas. Un "sencillo" ejemplo es el siguiente:</p>
<p><span style="font-family: andale mono, monospace;"><em>SELECT Pedidos.IdPedido, Cargo, NombreCategoria</em></span></p>
<p><span style="font-family: andale mono, monospace;"><em>FROM Pedidos, `Detalles de pedidos` AS Detalles, Productos, Categorias</em></span></p>
<p><span style="font-family: andale mono, monospace;"><em>WHERE Pedidos.IdPedido = detalles.IdPedido AND detalles.IdProducto = Productos.idProducto AND Productos.IdCategoria = Categorias.IdCategoria AND Cargo &gt; 120;</em></span></p>
<p></p>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice" id="id130">
<div class="iDevice emphasis1" >
<header class="iDevice_header iDevice_header_noIcon"><h1 class="iDeviceTitle">INNER, LEFT y RIGHT JOIN</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta130_149_2" class="block iDevice_content">
<div class="exe-text"><p>La selección multitabla anterior se basa en el producto cartesiano de los elementos de cada tabla separada por coma filtrados por la coincidencia de los campos clave y foráneo (ajeno). El siguiente ejemplo muestra el producto cartesiano de la tabla Camisas y la tabla Pantalones.</p>
<p style="text-align: center;"><strong>SELECT Camisas.*, Pantalones.* FROM Camisas, Pantalones;</strong></p>
<p><a href="cartesiano.png"><img src="cartesiano.png" style="display: block; margin-left: auto; margin-right: auto;" width="801" height="116" /></a></p>
<p>Cuando se aplica la condición mediante la sentencia WHERE, se escogen únicamente los registros en los que el valor de un campo en Camisas sea igual al valor de otro campo en Pantalones.</p>
<p>Por ejemplo, ... <em>WHERE ID_Camisas=ID_Pantalones</em> extraería sólo los registros en los que la primera y cuarta columnas fuera iguales (2 registros como se puede observar).</p>
<hr />
<p>Se debe evitar el uso de este método en tablas muy grandes debido al gasto computacional que supone. En vez de ello se usan las cláusulas <strong>INNER JOIN</strong>, <strong>LEFT JOIN</strong> y <strong>RIGHT JOIN</strong> que seleccionan durante el proceso gracias a la comparación entre dos campos (al igual que en el método anterior) mediante la cláusula <strong>ON</strong>.</p>
<ul>
<li><strong><a href="joins.jpg"><img src="joins.jpg" alt="" style="float: right; margin: 15px;" width="480" height="378" /></a>INNER JOIN</strong>: Devuelve <strong>todas las filas</strong> cuando hay al menos <strong>una coincidencia</strong> en <strong>ambas</strong> tablas.</li>
<li><strong>LEFT JOIN</strong>: Devuelve todas las filas de la tabla de la <strong>izquierda</strong>, y las filas coincidentes de la tabla de la <strong>derecha</strong>.</li>
<li><strong>RIGHT JOIN</strong>: Devuelve todas las filas de la tabla de la <strong>derecha</strong>, y las filas coincidentes de la tabla de la <strong>izquierda</strong>.</li>
</ul>
<div class="exe-fx exe-tabs">
<h2>INNER JOIN</h2>
<p><strong>INNER JOIN</strong> selecciona todas las filas de las dos columnas siempre y cuando haya <strong>una coincidencia entre las columnas en ambas tablas</strong>. Es el tipo de JOIN más común.</p>
<div class="pre-code">
<div>
<pre><code>SELECT nombreColumna(s)
FROM tabla1
INNER JOIN tabla2
ON tabla1.nombreColumna=table2.nombreColumna;</code></pre>
</div>
</div>
<h2>LEFT JOIN</h2>
<p><strong>LEFT JOIN</strong> mantiene <strong>todas las filas de la tabla izquierda</strong> (la tabla1). Las filas de la tabla derecha se mostrarán si hay una coincidencia con las de la izquierda. Si existen valores en la tabla izquierda pero no en la tabla derecha, ésta mostrará <strong>NULL</strong>.</p>
<div class="pre-code">
<div>
<pre><code>SELECT nombreColumna(s)
FROM tabla1
LEFT JOIN tabla2
ON tabla1.nombreColumna=tabla2.nombreColumna;</code></pre>
</div>
</div>
<h2><code class="hljs sql"><span class="hljs-operator"><span class="hljs-keyword"><span style="font-size: 10pt;"></span></span><span style="font-size: 10pt;"></span></span></code>RIGHT JOIN</h2>
<p>Es igual que <strong>LEFT JOIN</strong> pero al revés. Ahora <strong>se mantienen todas las filas de la tabla derecha</strong> (tabla2). Las filas de la tabla izquierda se mostrarán si hay una coincidencia con las de la derecha. Si existen valores en la tabla derecha pero no en la tabla izquierda, ésta se mostrará <strong>null</strong>.</p>
<div class="pre-code">
<div>
<pre><code>SELECT nombreColumna(s)
FROM tabla1
RIGHT JOIN tabla2
ON tabla1.nombreColumna=tabla2.nombreColumna;</code></pre>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</article>
<div id="packageLicense" class="cc cc-by-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licencia Creative Commons Reconocimiento Compartir igual 4.0</a></p>
</div>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="37_unin.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="39_consultas_sumarias.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<footer id="siteFooter">Departamento de Informática del IES Punta del Verde.
Curso 2020 - 2021</footer></div>
<script type="text/javascript" src="pdv_js.js"></script></body></html>