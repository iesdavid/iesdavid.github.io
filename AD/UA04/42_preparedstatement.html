<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="exe_highlighter.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>4.2. PreparedStatement | UA03. Conectores </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="David Bermúdez" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="exe_highlighter.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<link rel="stylesheet" type="text/css" href="udl-content.css" />
<script type="text/javascript" src="udl-content.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
	</head>
<body class="exe-web-site" id="exe-node-12"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">UA03. Conectores</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">UA04. Gestión de la información</a></li>
   <li><a href="41_statement.html" class="no-ch">4.1. Statement</a></li>
   <li id="active"><a href="42_preparedstatement.html" class="active no-ch">4.2. PreparedStatement</a></li>
   <li><a href="43_resultset.html" class="no-ch">4.3. ResultSet</a></li>
   <li><a href="33_ejecucin_de_consultas.html" class="no-ch">3.3. Ejecución de consultas</a></li>
   <li><a href="34_consultas_preparadas.html" class="no-ch">3.4. Consultas preparadas</a></li>
   <li><a href="35_procedimientos_almacenados.html" class="no-ch">3.5. Procedimientos almacenados</a></li>
   <li><a href="36_transacciones.html" class="no-ch">3.6. Transacciones</a></li>
   <li><a href="37_excepciones_y_cierres.html" class="no-ch">3.7. Excepciones y cierres</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="41_statement.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="43_resultset.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">4.2. PreparedStatement</h1></header>
<article class="iDevice_wrapper UDLcontentIdevice" id="id26">
<div class="iDevice emphasis0" >
<div id="ta26_119_2" class="block iDevice_content">
<div class="exe-udlContent exe-udlContent-engagement"><section class="exe-udlContent-block"><div class="exe-udlContent-content"><div class="exe-udlContent-content-main"><p>Esta interfaz hereda de <strong>Statement</strong>, y nos dará mucha más funcionalidad respecto del objeto anterior. Este objeto nos ofrecerá más flexibilidad, permitiendo pasarle dinámicamente argumentos al objeto. Podremos usar todas las sentencias mencionadas anteriormente, igual que en el objeto <strong>Statement</strong>.</p>
<div class="highlighted-code language-java">
<div>
<pre><code>PreparedStatement pstmt = null;
try {
Estudiante estudiante = new Estudiante();
String SQL = "select from Estudiante where id=? And apellido
= ?";
pstmt = conn.prepareStatement(SQL);
pstmt.setInt(1, estudiante.getId());
pstmt.setString(2, estudiante.getApellido());
//continuación de código
}catch (SQLException e) {
//continuación de código
}
finally {
pstmt.close();</code></pre>
</div>
</div>
<p>En JDBC, los parámetros que vemos en la sentencia SQL están representados por un símbolo de interrogación, conocido como <strong>marcador de parámetro</strong>. Tendremos que proporcionar valores para cada parámetro antes de ejecutar la consulta.</p>
<p>Estos valores los podremos asignar con los datos de nuestro objeto Java, en este caso, el objeto "Estudiante" con los getters<strong> getId()</strong> y <strong>getApellido()</strong>, que recogerán el valor de este atributo y nos servirán para asignárselo de manera dinámica. Si no se asignan los argumentos, se lanzará una excepción de tipo <strong>SQLException</strong>.</p>
<p>Este tipo de objeto también dispone de los mismos métodos que el objeto que hemos visto en el apartado anterior, pero, como diferencia, a estos métodos podemos pasarles parámetros.</p>
<ul>
<li><strong>execute(String sql)</strong>: se usa para ejecutar consultas dinámicas SQL.</li>
<li><strong>executeUpdate(String sql)</strong>: se usa cuando hacemos insert, delete o update.</li>
<li><strong>executeQuery(String sql)</strong>: se usa para realizar select.</li>
</ul>
<p>Si nos fijamos, al final del ejemplo también tenemos un <strong>close()</strong> para este tipo de objetos, ya que no es diferente de lo mencionado anteriormente. Siempre que abramos un objeto para interactuar con una BBDD, tendremos que cerrarlo al final de su uso.</p></div></div></section></div>
</div>
</div>
</article>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0</a></p>
</div>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="41_statement.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="43_resultset.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<script type="text/javascript" src="_cedec_js.js"></script></body></html>